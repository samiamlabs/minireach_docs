

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Overview &mdash; minireach latest documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="minireach latest documentation" href="index.html"/>
        <link rel="prev" title="Known Issues" href="known_issues.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> minireach
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing Truck Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="robot_hardware.html">Robot Hardware Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="computer.html">Truck Computer Overview and Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="care_and_feeding.html">Care And Feeding</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="demo_teleop.html">Demo: Control the truck using a game-pad</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gazebo.html">Tutorial: Gazebo Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">Tutorial: Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi-agent_demo.html">Tutorial: Multiple trucks</a></li>
<li class="toctree-l1"><a class="reference internal" href="teleop.html">Tutorial: Robot Teleop</a></li>
<li class="toctree-l1"><a class="reference internal" href="perception.html">Perception Resources</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pallet_tracker.html">Component: Pallet tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="state_space.html">Component: State space model</a></li>
<li class="toctree-l1"><a class="reference internal" href="robot_description.html">Component: Robot Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="precision_control.html">Component: Precision control</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="known_issues.html">Known Issues</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fork-and-reach">Fork and Reach</a></li>
<li class="toctree-l2"><a class="reference internal" href="#base-interface">Base Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#d-camera-tilt-interface">3D Camera Tilt Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#d-camera-interface">3D Camera Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#laser-interface">Laser Interface</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">minireach</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>API Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api_overview.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-overview">
<h1>API Overview<a class="headerlink" href="#api-overview" title="Permalink to this headline">¶</a></h1>
<p>One of the ways in which we have tried to create a good experience for
new developers is by using standard ROS interfaces. This means that code you
might have written for other robots in the past should be easily portable
to your new robot.</p>
<p>Whenever possible, we have conformed to the
<a class="reference external" href="http://www.ros.org/reps/rep-0000.html">ROS Enhancement Proposals (REPs)</a>.
These documents provide the foundation of standard ROS interfaces.</p>
<div class="section" id="fork-and-reach">
<h2>Fork and Reach<a class="headerlink" href="#fork-and-reach" title="Permalink to this headline">¶</a></h2>
<p>The fork and reach of the robot are controlled by an interface defined in
<a class="reference external" href="http://wiki.ros.org/robot_mechanism_controllers/JointPositionController">robot_mechanism_controllers/JointPositionController</a></p>
<p>Publishing a float to the /minireach/fork_position_controller/command topic will make the controller try to move the linear motor that controls the fork to an extension defined by the float in meters. For the moment,
height 0.0 is calibrated to mean that the underside of the forks are touching the ground and can not go any lower. The top of the forks will end up at about 1 cm (thickness of the forks) above the published height because of this.</p>
<p>The reach joint can be controlled in a similar manner by publishing to /minireach/reach_position_controller/command.</p>
<p>Only one controller is allowed to control a joint at a time.</p>
</div>
<div class="section" id="base-interface">
<span id="base-api"></span><h2>Base Interface<a class="headerlink" href="#base-interface" title="Permalink to this headline">¶</a></h2>
<p>Support for mobile bases is quite standard and robust in ROS, however it is one
of the older interfaces. As such, it is one of the few interfaces which is not
action-based.</p>
<p>The mobile base subscribes to <cite>base_controller/command</cite>, and accepts a
<a class="reference external" href="http://docs.ros.org/api/geometry_msgs/html/msg/Twist.html">geometry_msgs/Twist</a>
message.</p>
<p>Only two fields are used in the message:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">linear.x</span></code> specifies the robot’s forward velocity</li>
<li><code class="docutils literal"><span class="pre">angular.z</span></code> specifies the robot’s turning velocity</li>
</ul>
</div></blockquote>
<p>User applications will typically not connect directly to <cite>base_controller/command</cite>,
but rather to <cite>cmd_vel</cite> or <cite>nav_vel</cite>. A multiplexer is always running between <cite>teleop_vel</cite>
and <cite>cmd_vel</cite> and a few other topics. Whenever the deadman on the robot controller is held, <cite>teleop_vel</cite>
will override <cite>cmd_vel</cite>. The advantage of having your application publish to <cite>nav_vel</cite>
rather than directly to <cite>base_controller/command</cite> is that you can override bad
commands by simply pressing the deadman on the robot controller.</p>
<p>The truck has support for speed reduction when in the proximity of
obstacles. When this system is active, the truck will not be able to drive into
obstacles that are detected by the laser scanners. Is will also limit the maximum allowed speed close to
obstacles.
This prevents the truck from picking upp pallets, so it has to be deactivated
during pallet handling.</p>
<div class="align-centered figure align-center">
<a class="reference internal image-reference" href="_images/safety_on.png"><img alt="_images/safety_on.png" src="_images/safety_on.png" style="width: 100%;" /></a>
</div>
<p>The visualization of the safety fields turns red when some obstacle (red arrow)
is in the stop field (red rectangle). This completly stops the truck from moving
in that direction.</p>
<p>This terminal command diables safety as long as it is running:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">rostopic</span> <span class="n">pub</span> <span class="o">-</span><span class="n">r</span> <span class="mi">10</span> <span class="o">/</span><span class="n">disable_safety</span> <span class="n">std_msgs</span><span class="o">/</span><span class="n">String</span> <span class="s2">&quot;data: &#39;&#39;&quot;</span>
</pre></div>
</div>
<div class="align-centered figure align-center">
<a class="reference internal image-reference" href="_images/safety_off.png"><img alt="_images/safety_off.png" src="_images/safety_off.png" style="width: 100%;" /></a>
</div>
</div>
<div class="section" id="d-camera-tilt-interface">
<span id="head-api"></span><h2>3D Camera Tilt Interface<a class="headerlink" href="#d-camera-tilt-interface" title="Permalink to this headline">¶</a></h2>
<p>The 3D camera in the fork facing direction on the robot is controlled by an
interface defined in <a class="reference external" href="http://wiki.ros.org/robot_mechanism_controllers/JointPositionController">robot_mechanism_controllers/JointPositionController</a></p>
<p>Publishing a float to the /minireach/camera_tilt_controller/command topic will make the controller try to move the camera tilt axis to the angle defined by the value of that float in radians.</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">rostopic</span> <span class="n">pub</span> <span class="o">/</span><span class="n">camera_tilt_controller</span><span class="o">/</span><span class="n">command</span> <span class="n">std_msgs</span><span class="o">/</span><span class="n">Float6</span><span class="s2">&quot;data: 0.8&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="d-camera-interface">
<span id="camera-api"></span><h2>3D Camera Interface<a class="headerlink" href="#d-camera-interface" title="Permalink to this headline">¶</a></h2>
<p>We have been avaluating two different 3D cameras for the MiniReach, the ZED stereo camera and the structured light based (kinect like) Orbbec Astra.</p>
<p>The following infromation is for the Orbbec Astra.</p>
<p>The fork facing camera exposes several topics of interest:</p>
<blockquote>
<div><ul class="simple">
<li><cite>camera/depth_registered/points</cite> is a <a class="reference external" href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>
which has both 3d and color data. It is published at VGA resolution (640x480)
at 30Hz.</li>
<li><cite>camera/rgb/image_raw</cite> is a <a class="reference external" href="http://docs.ros.org/api/sensor_msgs/html/msg/Image.html">sensor_msgs/Image</a>.
This is just the 2d unrectified color data. It is published at VGA resolution (640x480)</li>
<li><cite>camera/rgb/image_rect_color</cite> is a <a class="reference external" href="http://docs.ros.org/api/sensor_msgs/html/msg/Image.html">sensor_msgs/Image</a>.  This is the rectified 2d color data. In simulation this topic is a slightly delayed copy of <cite>camera/rgb/image_raw</cite>.  On the real truck this
It is published at VGA resolution (640x480)
at 3330Hz.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="laser-interface">
<span id="laser-api"></span><h2>Laser Interface<a class="headerlink" href="#laser-interface" title="Permalink to this headline">¶</a></h2>
<p><cite>scan1</cite> is a <a class="reference external" href="http://docs.ros.org/api/sensor_msgs/html/msg/LaserScan.html">sensor_msgs/LaserScan</a> from the fork laser.
<cite>scan2</cite> is a <a class="reference external" href="http://docs.ros.org/api/sensor_msgs/html/msg/LaserScan.html">sensor_msgs/LaserScan</a> from the drive_wheel laser.
<cite>scan</cite> is a merged version of <cite>scan1</cite> and <cite>scan2</cite> on the <cite>base footprint</cite> frame. (used by SLAM algoritm)</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="known_issues.html" class="btn btn-neutral" title="Known Issues" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Samuel Lindgren.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'latest',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>